

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>RMutils package &mdash; RM-Tools 1.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> RM-Tools
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">RMutils package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-RMutils.corner">RMutils.corner module</a></li>
<li><a class="reference internal" href="#module-RMutils.mpfit">RMutils.mpfit module</a></li>
<li><a class="reference internal" href="#module-RMutils.nestle">RMutils.nestle module</a></li>
<li><a class="reference internal" href="#module-RMutils.normalize">RMutils.normalize module</a></li>
<li><a class="reference internal" href="#module-RMutils.util_FITS">RMutils.util_FITS module</a></li>
<li><a class="reference internal" href="#module-RMutils.util_RM">RMutils.util_RM module</a></li>
<li><a class="reference internal" href="#module-RMutils.util_misc">RMutils.util_misc module</a></li>
<li><a class="reference internal" href="#module-RMutils.util_plotFITS">RMutils.util_plotFITS module</a></li>
<li><a class="reference internal" href="#module-RMutils.util_plotTk">RMutils.util_plotTk module</a></li>
<li><a class="reference internal" href="#module-RMutils.util_rec">RMutils.util_rec module</a></li>
<li><a class="reference internal" href="#module-RMutils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RM-Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>RMutils package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/RMutils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rmutils-package">
<h1>RMutils package<a class="headerlink" href="#rmutils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="RMutils.emcee.html">RMutils.emcee package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.autocorr">RMutils.emcee.autocorr module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.ensemble">RMutils.emcee.ensemble module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.interruptible_pool">RMutils.emcee.interruptible_pool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.mh">RMutils.emcee.mh module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.mpi_pool">RMutils.emcee.mpi_pool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.ptsampler">RMutils.emcee.ptsampler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.sampler">RMutils.emcee.sampler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.tests">RMutils.emcee.tests module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee.utils">RMutils.emcee.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMutils.emcee.html#module-RMutils.emcee">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-RMutils.corner">
<span id="rmutils-corner-module"></span><h2>RMutils.corner module<a class="headerlink" href="#module-RMutils.corner" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="RMutils.corner.corner">
<code class="sig-prename descclassname"><span class="pre">RMutils.corner.</span></code><code class="sig-name descname"><span class="pre">corner</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth1d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_titles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.2f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truth_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#4682b4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n_ticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_ticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_math_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hist2d_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.corner.corner" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a <em>sick</em> corner plot showing the projections of a data set in a
multi-dimensional space. kwargs are passed to hist2d() or used for
<cite>matplotlib</cite> styling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>array_like[nsamples, ndim]</em>) – The samples. This should be a 1- or 2-dimensional array. For a 1-D
array this results in a simple histogram. For a 2-D array, the zeroth
axis is the list of samples and the next axis are the dimensions of
the space.</p></li>
<li><p><strong>bins</strong> (<em>int or array_like[ndim,]</em>) – The number of bins to use in histograms, either as a fixed value for
all dimensions, or as a list of integers for each dimension.</p></li>
<li><p><strong>weights</strong> (<em>array_like[nsamples,]</em>) – The weight of each sample. If <cite>None</cite> (default), samples are given
equal weight.</p></li>
<li><p><strong>color</strong> (<em>str</em>) – A <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> style color for all histograms.</p></li>
<li><p><strong>smooth, smooth1d</strong> (<em>float</em>) – The standard deviation for Gaussian kernel passed to
<cite>scipy.ndimage.gaussian_filter</cite> to smooth the 2-D and 1-D histograms
respectively. If <cite>None</cite> (default), no smoothing is applied.</p></li>
<li><p><strong>labels</strong> (<em>iterable (ndim,)</em>) – A list of names for the dimensions. If a <code class="docutils literal notranslate"><span class="pre">xs</span></code> is a
<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, labels will default to column names.</p></li>
<li><p><strong>label_kwargs</strong> (<em>dict</em>) – Any extra keyword arguments to send to the <cite>set_xlabel</cite> and
<cite>set_ylabel</cite> methods.</p></li>
<li><p><strong>show_titles</strong> (<em>bool</em>) – Displays a title above each 1-D histogram showing the 0.5 quantile
with the upper and lower errors supplied by the quantiles argument.</p></li>
<li><p><strong>title_fmt</strong> (<em>string</em>) – The format string for the quantiles given in titles. If you explicitly
set <code class="docutils literal notranslate"><span class="pre">show_titles=True</span></code> and <code class="docutils literal notranslate"><span class="pre">title_fmt=None</span></code>, the labels will be
shown as the titles. (default: <code class="docutils literal notranslate"><span class="pre">.2f</span></code>)</p></li>
<li><p><strong>title_kwargs</strong> (<em>dict</em>) – Any extra keyword arguments to send to the <cite>set_title</cite> command.</p></li>
<li><p><strong>range</strong> (<em>iterable (ndim,)</em>) – A list where each element is either a length 2 tuple containing
lower and upper bounds or a float in range (0., 1.)
giving the fraction of samples to include in bounds, e.g.,
[(0.,10.), (1.,5), 0.999, etc.].
If a fraction, the bounds are chosen to be equal-tailed.</p></li>
<li><p><strong>truths</strong> (<em>iterable (ndim,)</em>) – A list of reference values to indicate on the plots.  Individual
values can be omitted by using <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>truth_color</strong> (<em>str</em>) – A <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> style color for the <code class="docutils literal notranslate"><span class="pre">truths</span></code> makers.</p></li>
<li><p><strong>scale_hist</strong> (<em>bool</em>) – Should the 1-D histograms be scaled in such a way that the zero line
is visible?</p></li>
<li><p><strong>quantiles</strong> (<em>iterable</em>) – A list of fractional quantiles to show on the 1-D histograms as
vertical dashed lines.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If true, print the values of the computed quantiles.</p></li>
<li><p><strong>plot_contours</strong> (<em>bool</em>) – Draw contours for dense regions of the plot.</p></li>
<li><p><strong>use_math_text</strong> (<em>bool</em>) – If true, then axis tick labels for very large or small exponents will
be displayed as powers of 10 rather than using <cite>e</cite>.</p></li>
<li><p><strong>reverse</strong> (<em>bool</em>) – If true, plot the corner plot starting in the upper-right corner instead
of the usual bottom-left corner</p></li>
<li><p><strong>max_n_ticks</strong> (<em>int</em>) – Maximum number of ticks to try to use</p></li>
<li><p><strong>top_ticks</strong> (<em>bool</em>) – If true, label the top ticks of each axis</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.Figure</em>) – Overplot onto the provided figure object.</p></li>
<li><p><strong>hist_kwargs</strong> (<em>dict</em>) – Any extra keyword arguments to send to the 1-D histogram plots.</p></li>
<li><p><strong>**hist2d_kwargs</strong> – Any remaining keyword arguments are sent to <cite>corner.hist2d</cite> to generate
the 2-D histogram plots.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="RMutils.corner.hist2d">
<code class="sig-prename descclassname"><span class="pre">RMutils.corner.</span></code><code class="sig-name descname"><span class="pre">hist2d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_datapoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_fill_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contourf_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.corner.hist2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a 2-D histogram of samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like[nsamples,]</em>) – The samples.</p></li>
<li><p><strong>y</strong> (<em>array_like[nsamples,]</em>) – The samples.</p></li>
<li><p><strong>levels</strong> (<em>array_like</em>) – The contour levels to draw.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.Axes</em>) – A axes instance on which to add the 2-D histogram.</p></li>
<li><p><strong>plot_datapoints</strong> (<em>bool</em>) – Draw the individual data points.</p></li>
<li><p><strong>plot_density</strong> (<em>bool</em>) – Draw the density colormap.</p></li>
<li><p><strong>plot_contours</strong> (<em>bool</em>) – Draw the contours.</p></li>
<li><p><strong>no_fill_contours</strong> (<em>bool</em>) – Add no filling at all to the contours (unlike setting
<code class="docutils literal notranslate"><span class="pre">fill_contours=False</span></code>, which still adds a white fill at the densest
points).</p></li>
<li><p><strong>fill_contours</strong> (<em>bool</em>) – Fill the contours.</p></li>
<li><p><strong>contour_kwargs</strong> (<em>dict</em>) – Any additional keyword arguments to pass to the <cite>contour</cite> method.</p></li>
<li><p><strong>contourf_kwargs</strong> (<em>dict</em>) – Any additional keyword arguments to pass to the <cite>contourf</cite> method.</p></li>
<li><p><strong>data_kwargs</strong> (<em>dict</em>) – Any additional keyword arguments to pass to the <cite>plot</cite> method when
adding the individual data points.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="RMutils.corner.quantile">
<code class="sig-prename descclassname"><span class="pre">RMutils.corner.</span></code><code class="sig-name descname"><span class="pre">quantile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.corner.quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sample quantiles with support for weighted samples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">weights</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, this method simply calls numpy’s percentile
function with the values of <code class="docutils literal notranslate"><span class="pre">q</span></code> multiplied by 100.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like[nsamples,]</em>) – The samples.</p></li>
<li><p><strong>q</strong> (<em>array_like[nquantiles,]</em>) – The list of quantiles to compute. These should all be in the range
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>weights</strong> (<em>Optional[array_like[nsamples,]]</em>) – An optional weight corresponding to each sample. These</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>quantiles</strong> – The sample quantiles computed at <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like[nquantiles,]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For invalid quantiles; <code class="docutils literal notranslate"><span class="pre">q</span></code> not in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code> or dimension mismatch
    between <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">weights</span></code>.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-RMutils.mpfit">
<span id="rmutils-mpfit-module"></span><h2>RMutils.mpfit module<a class="headerlink" href="#module-RMutils.mpfit" title="Permalink to this headline">¶</a></h2>
<p>Perform Levenberg-Marquardt least-squares minimization, based on MINPACK-1.</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>AUTHORS</p>
</div></blockquote>
<p>The original version of this software, called LMFIT, was written in FORTRAN
as part of the MINPACK-1 package by XXX.</p>
<p>Craig Markwardt converted the FORTRAN code to IDL.  The information for the
IDL version is:</p>
<blockquote>
<div><p>Craig B. Markwardt, NASA/GSFC Code 662, Greenbelt, MD 20770
<a class="reference external" href="mailto:craigm&#37;&#52;&#48;lheamail&#46;gsfc&#46;nasa&#46;gov">craigm<span>&#64;</span>lheamail<span>&#46;</span>gsfc<span>&#46;</span>nasa<span>&#46;</span>gov</a>
UPDATED VERSIONs can be found on my WEB PAGE:</p>
<blockquote>
<div><p><a class="reference external" href="http://cow.physics.wisc.edu/~craigm/idl/idl.html">http://cow.physics.wisc.edu/~craigm/idl/idl.html</a></p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>Mark Rivers created this Python version from Craig’s IDL version.</dt><dd><p>Mark Rivers, University of Chicago
Building 434A, Argonne National Laboratory
9700 South Cass Avenue, Argonne, IL 60439
<a class="reference external" href="mailto:rivers&#37;&#52;&#48;cars&#46;uchicago&#46;edu">rivers<span>&#64;</span>cars<span>&#46;</span>uchicago<span>&#46;</span>edu</a>
Updated versions can be found at <a class="reference external" href="http://cars.uchicago.edu/software">http://cars.uchicago.edu/software</a></p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>Sergey Koposov converted the Mark’s Python version from Numeric to numpy</dt><dd><blockquote>
<div><p>Sergey Koposov, University of Cambridge, Institute of Astronomy,
Madingley road, CB3 0HA, Cambridge, UK
<a class="reference external" href="mailto:koposov&#37;&#52;&#48;ast&#46;cam&#46;ac&#46;uk">koposov<span>&#64;</span>ast<span>&#46;</span>cam<span>&#46;</span>ac<span>&#46;</span>uk</a>
Updated versions can be found at <a class="reference external" href="http://code.google.com/p/astrolibpy/source/browse/trunk/">http://code.google.com/p/astrolibpy/source/browse/trunk/</a></p>
</div></blockquote>
<dl class="simple">
<dt>UPDATE 2016-05-15: Cormac Purcell updated this version to use the latest</dt><dd><p>SciPy blas libraries and explicitly copy arrays when
calculating the diagonal (np.diagonal()).</p>
</dd>
</dl>
<p>UPDATE 2017-03-12: Cormac Purcell updated this for use with Python3.</p>
<blockquote>
<div><p>DESCRIPTION</p>
</div></blockquote>
</dd>
</dl>
<p>MPFIT uses the Levenberg-Marquardt technique to solve the
least-squares problem.  In its typical use, MPFIT will be used to
fit a user-supplied function (the ‘model’) to user-supplied data
points (the ‘data’) by adjusting a set of parameters.  MPFIT is
based upon MINPACK-1 (LMDIF.F) by More’ and collaborators.</p>
<p>For example, a researcher may think that a set of observed data
points is best modelled with a Gaussian curve.  A Gaussian curve is
parameterized by its mean, standard deviation and normalization.
MPFIT will, within certain constraints, find the set of parameters
which best fits the data.  The fit is ‘best’ in the least-squares
sense; that is, the sum of the weighted squared differences between
the model and data is minimized.</p>
<p>The Levenberg-Marquardt technique is a particular strategy for
iteratively searching for the best fit.  This particular
implementation is drawn from MINPACK-1 (see NETLIB), and is much faster
and more accurate than the version provided in the Scientific Python package
in Scientific.Functions.LeastSquares.
This version allows upper and lower bounding constraints to be placed on each
parameter, or the parameter can be held fixed.</p>
<p>The user-supplied Python function should return an array of weighted
deviations between model and data.  In a typical scientific problem
the residuals should be weighted so that each deviate has a
gaussian sigma of 1.0.  If X represents values of the independent
variable, Y represents a measurement for each value of X, and ERR
represents the error in the measurements, then the deviates could
be calculated as follows:</p>
<blockquote>
<div><p>DEVIATES = (Y - F(X)) / ERR</p>
</div></blockquote>
<p>where F is the analytical function representing the model.  You are
recommended to use the convenience functions MPFITFUN and
MPFITEXPR, which are driver functions that calculate the deviates
for you.  If ERR are the 1-sigma uncertainties in Y, then</p>
<blockquote>
<div><p>TOTAL( DEVIATES^2 )</p>
</div></blockquote>
<p>will be the total chi-squared value.  MPFIT will minimize the
chi-square value.  The values of X, Y and ERR are passed through
MPFIT to the user-supplied function via the FUNCTKW keyword.</p>
<p>Simple constraints can be placed on parameter values by using the
PARINFO keyword to MPFIT.  See below for a description of this
keyword.</p>
<p>MPFIT does not perform more general optimization tasks.  See TNMIN
instead.  MPFIT is customized, based on MINPACK-1, to the
least-squares minimization problem.</p>
<blockquote>
<div><p>USER FUNCTION</p>
</div></blockquote>
<p>The user must define a function which returns the appropriate
values as specified above.  The function should return the weighted
deviations between the model and the data.  It should also return a status
flag and an optional partial derivative array.  For applications which
use finite-difference derivatives – the default – the user
function should be declared in the following way:</p>
<blockquote>
<div><dl class="simple">
<dt>def myfunct(p, fjac=None, x=None, y=None, err=None)</dt><dd><p># Parameter values are passed in “p”
# If fjac==None then partial derivatives should not be
# computed.  It will always be None if MPFIT is called with default
# flag.
model = F(x, p)
# Non-negative status value means MPFIT should continue, negative means
# stop the calculation.
status = 0
return([status, (y-model)/err]</p>
</dd>
</dl>
</div></blockquote>
<p>See below for applications with analytical derivatives.</p>
<p>The keyword parameters X, Y, and ERR in the example above are
suggestive but not required.  Any parameters can be passed to
MYFUNCT by using the functkw keyword to MPFIT.  Use MPFITFUN and
MPFITEXPR if you need ideas on how to do that.  The function <em>must</em>
accept a parameter list, P.</p>
<p>In general there are no restrictions on the number of dimensions in
X, Y or ERR.  However the deviates <em>must</em> be returned in a
one-dimensional Numeric array of type Float.</p>
<p>User functions may also indicate a fatal error condition using the
status return described above. If status is set to a number between
-15 and -1 then MPFIT will stop the calculation and return to the caller.</p>
<blockquote>
<div><p>ANALYTIC DERIVATIVES</p>
</div></blockquote>
<p>In the search for the best-fit solution, MPFIT by default
calculates derivatives numerically via a finite difference
approximation.  The user-supplied function need not calculate the
derivatives explicitly.  However, if you desire to compute them
analytically, then the AUTODERIVATIVE=0 keyword must be passed to MPFIT.
As a practical matter, it is often sufficient and even faster to allow
MPFIT to calculate the derivatives numerically, and so
AUTODERIVATIVE=0 is not necessary.</p>
<p>If AUTODERIVATIVE=0 is used then the user function must check the parameter
FJAC, and if FJAC!=None then return the partial derivative array in the
return list.</p>
<blockquote>
<div><dl>
<dt>def myfunct(p, fjac=None, x=None, y=None, err=None)</dt><dd><p># Parameter values are passed in “p”
# If FJAC!=None then partial derivatives must be comptuer.
# FJAC contains an array of len(p), where each entry
# is 1 if that parameter is free and 0 if it is fixed.
model = F(x, p)
Non-negative status value means MPFIT should continue, negative means
# stop the calculation.
status = 0
if (dojac):</p>
<blockquote>
<div><p>pderiv = zeros([len(x), len(p)], Float)
for j in range(len(p)):</p>
<blockquote>
<div><p>pderiv[:,j] = FGRAD(x, p, j)</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>else:</dt><dd><p>pderiv = None</p>
</dd>
</dl>
<p>return([status, (y-model)/err, pderiv]</p>
</dd>
</dl>
</div></blockquote>
<p>where FGRAD(x, p, i) is a user function which must compute the
derivative of the model with respect to parameter P[i] at X.  When
finite differencing is used for computing derivatives (ie, when
AUTODERIVATIVE=1), or when MPFIT needs only the errors but not the
derivatives the parameter FJAC=None.</p>
<p>Derivatives should be returned in the PDERIV array. PDERIV should be an m x
n array, where m is the number of data points and n is the number
of parameters.  dp[i,j] is the derivative at the ith point with
respect to the jth parameter.</p>
<p>The derivatives with respect to fixed parameters are ignored; zero
is an appropriate value to insert for those derivatives.  Upon
input to the user function, FJAC is set to a vector with the same
length as P, with a value of 1 for a parameter which is free, and a
value of zero for a parameter which is fixed (and hence no
derivative needs to be calculated).</p>
<p>If the data is higher than one dimensional, then the <em>last</em>
dimension should be the parameter dimension.  Example: fitting a
50x50 image, “dp” should be 50x50xNPAR.</p>
<blockquote>
<div><p>CONSTRAINING PARAMETER VALUES WITH THE PARINFO KEYWORD</p>
</div></blockquote>
<p>The behavior of MPFIT can be modified with respect to each
parameter to be fitted.  A parameter value can be fixed; simple
boundary constraints can be imposed; limitations on the parameter
changes can be imposed; properties of the automatic derivative can
be modified; and parameters can be tied to one another.</p>
<p>These properties are governed by the PARINFO structure, which is
passed as a keyword parameter to MPFIT.</p>
<p>PARINFO should be a list of dictionaries, one list entry for each parameter.
Each parameter is associated with one element of the array, in
numerical order.  The dictionary can have the following keys
(none are required, keys are case insensitive):</p>
<blockquote>
<div><dl>
<dt>‘value’ - the starting parameter value (but see the START_PARAMS</dt><dd><p>parameter for more information).</p>
</dd>
<dt>‘fixed’ - a boolean value, whether the parameter is to be held</dt><dd><p>fixed or not.  Fixed parameters are not varied by
MPFIT, but are passed on to MYFUNCT for evaluation.</p>
</dd>
<dt>‘limited’ - a two-element boolean array.  If the first/second</dt><dd><p>element is set, then the parameter is bounded on the
lower/upper side.  A parameter can be bounded on both
sides.  Both LIMITED and LIMITS must be given
together.</p>
</dd>
<dt>‘limits’ - a two-element float array.  Gives the</dt><dd><p>parameter limits on the lower and upper sides,
respectively.  Zero, one or two of these values can be
set, depending on the values of LIMITED.  Both LIMITED
and LIMITS must be given together.</p>
</dd>
<dt>‘parname’ - a string, giving the name of the parameter.  The</dt><dd><p>fitting code of MPFIT does not use this tag in any
way.  However, the default iterfunct will print the
parameter name if available.</p>
</dd>
<dt>‘step’ - the step size to be used in calculating the numerical</dt><dd><p>derivatives.  If set to zero, then the step size is
computed automatically.  Ignored when AUTODERIVATIVE=0.</p>
</dd>
<dt>‘mpside’ - the sidedness of the finite difference when computing</dt><dd><blockquote>
<div><p>numerical derivatives.  This field can take four
values:</p>
<blockquote>
<div><blockquote>
<div><p>0 - one-sided derivative computed automatically
1 - one-sided derivative (f(x+h) - f(x)  )/h</p>
</div></blockquote>
<dl class="simple">
<dt>-1 - one-sided derivative (f(x)   - f(x-h))/h</dt><dd><p>2 - two-sided derivative (f(x+h) - f(x-h))/(2*h)</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p>Where H is the STEP parameter described above.  The
‘automatic’ one-sided derivative method will chose a
direction for the finite difference which does not
violate any constraints.  The other methods do not
perform this check.  The two-sided method is in
principle more precise, but requires twice as many
function evaluations.  Default: 0.</p>
</dd>
<dt>‘mpmaxstep’ - the maximum change to be made in the parameter</dt><dd><p>value.  During the fitting process, the parameter
will never be changed by more than this value in
one iteration.</p>
<p>A value of 0 indicates no maximum.  Default: 0.</p>
</dd>
<dt>‘tied’ - a string expression which “ties” the parameter to other</dt><dd><p>free or fixed parameters.  Any expression involving
constants and the parameter array P are permitted.
Example: if parameter 2 is always to be twice parameter
1 then use the following: parinfo(2).tied = ‘2 * p(1)’.
Since they are totally constrained, tied parameters are
considered to be fixed; no errors are computed for them.
[ NOTE: the PARNAME can’t be used in expressions. ]</p>
</dd>
<dt>‘mpprint’ - if set to 1, then the default iterfunct will print the</dt><dd><p>parameter value.  If set to 0, the parameter value
will not be printed.  This tag can be used to
selectively print only a few parameter values out of
many.  Default: 1 (all parameters printed)</p>
</dd>
</dl>
</div></blockquote>
<p>Future modifications to the PARINFO structure, if any, will involve
adding dictionary tags beginning with the two letters ‘MP’.
Therefore programmers are urged to avoid using tags starting with
the same letters; otherwise they are free to include their own
fields within the PARINFO structure, and they will be ignored.</p>
<p>PARINFO Example:
parinfo = [{‘value’:0., ‘fixed’:0, ‘limited’:[0,0], ‘limits’:[0.,0.]}</p>
<blockquote>
<div><p>for i in range(5)]</p>
</div></blockquote>
<p>parinfo[0][‘fixed’] = 1
parinfo[4][‘limited’][0] = 1
parinfo[4][‘limits’][0]  = 50.
values = [5.7, 2.2, 500., 1.5, 2000.]
for i in range(5): parinfo[i][‘value’]=values[i]</p>
<p>A total of 5 parameters, with starting values of 5.7,
2.2, 500, 1.5, and 2000 are given.  The first parameter
is fixed at a value of 5.7, and the last parameter is
constrained to be above 50.</p>
<blockquote>
<div><blockquote>
<div><p>EXAMPLE</p>
</div></blockquote>
<p>import mpfit
import numpy.oldnumeric as Numeric
x = arange(100, float)
p0 = [5.7, 2.2, 500., 1.5, 2000.]
y = ( p[0] + p[1]*[x] + p[2]*[x**2] + p[3]*sqrt(x) +</p>
<blockquote>
<div><p>p[4]*log(x))</p>
</div></blockquote>
<p>fa = {‘x’:x, ‘y’:y, ‘err’:err}
m = mpfit(‘myfunct’, p0, functkw=fa)
print(‘status = ‘, m.status)
if (m.status &lt;= 0): print(‘error message = ‘, m.errmsg)
print(‘parameters = ‘, m.params)</p>
<p>Minimizes sum of squares of MYFUNCT.  MYFUNCT is called with the X,
Y, and ERR keyword parameters that are given by FUNCTKW.  The
results can be obtained from the returned object m.</p>
<blockquote>
<div><p>THEORY OF OPERATION</p>
</div></blockquote>
<p>There are many specific strategies for function minimization.  One
very popular technique is to use function gradient information to
realize the local structure of the function.  Near a local minimum
the function value can be taylor expanded about x0 as follows:</p>
<blockquote>
<div><blockquote>
<div><dl class="simple">
<dt>f(x) = f(x0) + f’(x0) . (x-x0) + (1/2) (x-x0) . f’’(x0) . (x-x0)</dt><dd><p>—–   —————   ——————————-  (1)</p>
</dd>
</dl>
</div></blockquote>
<p>Order  0th               1st                                     2nd</p>
</div></blockquote>
<p>Here f’(x) is the gradient vector of f at x, and f’’(x) is the
Hessian matrix of second derivatives of f at x.  The vector x is
the set of function parameters, not the measured data vector.  One
can find the minimum of f, f(xm) using Newton’s method, and
arrives at the following linear equation:</p>
<blockquote>
<div><p>f’’(x0) . (xm-x0) = - f’(x0)                                                  (2)</p>
</div></blockquote>
<p>If an inverse can be found for f’’(x0) then one can solve for
(xm-x0), the step vector from the current position x0 to the new
projected minimum.  Here the problem has been linearized (ie, the
gradient information is known to first order).  f’’(x0) is
symmetric n x n matrix, and should be positive definite.</p>
<p>The Levenberg - Marquardt technique is a variation on this theme.
It adds an additional diagonal term to the equation which may aid the
convergence properties:</p>
<blockquote>
<div><p>(f’’(x0) + nu I) . (xm-x0) = -f’(x0)                            (2a)</p>
</div></blockquote>
<p>where I is the identity matrix.  When nu is large, the overall
matrix is diagonally dominant, and the iterations follow steepest
descent.  When nu is small, the iterations are quadratically
convergent.</p>
<p>In principle, if f’’(x0) and f’(x0) are known then xm-x0 can be
determined.  However the Hessian matrix is often difficult or
impossible to compute.  The gradient f’(x0) may be easier to
compute, if even by finite difference techniques.  So-called
quasi-Newton techniques attempt to successively estimate f’’(x0)
by building up gradient information as the iterations proceed.</p>
<p>In the least squares problem there are further simplifications
which assist in solving eqn (2).  The function to be minimized is
a sum of squares:</p>
<blockquote>
<div><p>f = Sum(hi^2)                                                                                 (3)</p>
</div></blockquote>
<p>where hi is the ith residual out of m residuals as described
above.  This can be substituted back into eqn (2) after computing
the derivatives:</p>
<blockquote>
<div><p>f’  = 2 Sum(hi  hi’)
f’’ = 2 Sum(hi’ hj’) + 2 Sum(hi hi’’)                                (4)</p>
</div></blockquote>
<p>If one assumes that the parameters are already close enough to a
minimum, then one typically finds that the second term in f’’ is
negligible [or, in any case, is too difficult to compute].  Thus,
equation (2) can be solved, at least approximately, using only
gradient information.</p>
<p>In matrix notation, the combination of eqns (2) and (4) becomes:</p>
<blockquote>
<div><p>hT’ . h’ . dx = - hT’ . h                                                 (5)</p>
</div></blockquote>
<p>Where h is the residual vector (length m), hT is its transpose, h’
is the Jacobian matrix (dimensions n x m), and dx is (xm-x0).  The
user function supplies the residual vector h, and in some cases h’
when it is not found by finite differences (see MPFIT_FDJAC2,
which finds h and hT’).  Even if dx is not the best absolute step
to take, it does provide a good estimate of the best <em>direction</em>,
so often a line minimization will occur along the dx vector
direction.</p>
<p>The method of solution employed by MINPACK is to form the Q . R
factorization of h’, where Q is an orthogonal matrix such that QT .
Q = I, and R is upper right triangular.  Using h’ = Q . R and the
ortogonality of Q, eqn (5) becomes</p>
<blockquote>
<div><dl class="simple">
<dt>(RT . QT) . (Q . R) . dx = - (RT . QT) . h</dt><dd><dl class="simple">
<dt>RT . R . dx = - RT . QT . h             (6)</dt><dd><p>R . dx = - QT . h</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>where the last statement follows because R is upper triangular.
Here, R, QT and h are known so this is a matter of solving for dx.
The routine MPFIT_QRFAC provides the QR factorization of h, with
pivoting, and MPFIT_QRSOLV provides the solution for dx.</p>
<blockquote>
<div><p>REFERENCES</p>
</div></blockquote>
<p>MINPACK-1, Jorge More’, available from netlib (www.netlib.org).
“Optimization Software Guide,” Jorge More’ and Stephen Wright,</p>
<blockquote>
<div><p>SIAM, <em>Frontiers in Applied Mathematics</em>, Number 14.</p>
</div></blockquote>
<dl>
<dt>More’, Jorge J., “The Levenberg-Marquardt Algorithm:</dt><dd><p>Implementation and Theory,” in <em>Numerical Analysis</em>, ed. Watson,
G. A., Lecture Notes in Mathematics 630, Springer-Verlag, 1977.</p>
<blockquote>
<div><p>MODIFICATION HISTORY</p>
</div></blockquote>
</dd>
</dl>
<p>Translated from MINPACK-1 in FORTRAN, Apr-Jul 1998, CM</p>
</div></blockquote>
<p>Copyright (C) 1997-2002, Craig Markwardt
This software is provided as is without any warranty whatsoever.
Permission to use, copy, modify, and distribute modified or
unmodified copies is granted, provided this copyright and disclaimer
are included unchanged.</p>
<blockquote>
<div><p>Translated from MPFIT (Craig Markwardt’s IDL package) to Python,
August, 2002.  Mark Rivers
Converted from Numeric to numpy (Sergey Koposov, July 2008)</p>
</div></blockquote>
</div></blockquote>
<dl class="py class">
<dt id="RMutils.mpfit.machar">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">RMutils.mpfit.</span></code><code class="sig-name descname"><span class="pre">machar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">double</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.machar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="RMutils.mpfit.mpfit">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">RMutils.mpfit.</span></code><code class="sig-name descname"><span class="pre">mpfit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functkw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parinfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterfunct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterkw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocovar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autoderivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="RMutils.mpfit.mpfit.blas_enorm32">
<code class="sig-name descname"><span class="pre">blas_enorm32</span></code><em class="property"> <span class="pre">=</span> <span class="pre">&lt;fortran</span> <span class="pre">dnrm2&gt;</span></em><a class="headerlink" href="#RMutils.mpfit.mpfit.blas_enorm32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="RMutils.mpfit.mpfit.blas_enorm64">
<code class="sig-name descname"><span class="pre">blas_enorm64</span></code><em class="property"> <span class="pre">=</span> <span class="pre">&lt;fortran</span> <span class="pre">dnrm2&gt;</span></em><a class="headerlink" href="#RMutils.mpfit.mpfit.blas_enorm64" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.calc_covar">
<code class="sig-name descname"><span class="pre">calc_covar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipvt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.calc_covar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.call">
<code class="sig-name descname"><span class="pre">call</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functkw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fjac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.defiter">
<code class="sig-name descname"><span class="pre">defiter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functkw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parinfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%.10g'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.defiter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.enorm">
<code class="sig-name descname"><span class="pre">enorm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.enorm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.fdjac2">
<code class="sig-name descname"><span class="pre">fdjac2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ulimited</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ulimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dside</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autoderivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functkw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.fdjac2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.lmpar">
<code class="sig-name descname"><span class="pre">lmpar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipvt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qtb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.lmpar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.parinfo">
<code class="sig-name descname"><span class="pre">parinfo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parinfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.parinfo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.qrfac">
<code class="sig-name descname"><span class="pre">qrfac</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pivot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.qrfac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.qrsolv">
<code class="sig-name descname"><span class="pre">qrsolv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipvt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qtb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdiag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.qrsolv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="RMutils.mpfit.mpfit.tie">
<code class="sig-name descname"><span class="pre">tie</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptied</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.mpfit.mpfit.tie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-RMutils.nestle">
<span id="rmutils-nestle-module"></span><h2>RMutils.nestle module<a class="headerlink" href="#module-RMutils.nestle" title="Permalink to this headline">¶</a></h2>
<p>Nestle: nested sampling routines to evaluate Bayesian evidence.</p>
<dl class="py class">
<dt id="RMutils.nestle.Result">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">RMutils.nestle.</span></code><code class="sig-name descname"><span class="pre">Result</span></code><a class="headerlink" href="#RMutils.nestle.Result" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Represents a sampling result.</p>
<p>Since this class is essentially a subclass of dict with attribute
accessors, one can see which attributes are available using the
<cite>keys()</cite> method.</p>
<dl class="py method">
<dt id="RMutils.nestle.Result.summary">
<code class="sig-name descname"><span class="pre">summary</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.nestle.Result.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted string giving summary.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="RMutils.nestle.mean_and_cov">
<code class="sig-prename descclassname"><span class="pre">RMutils.nestle.</span></code><code class="sig-name descname"><span class="pre">mean_and_cov</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.nestle.mean_and_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute weighted sample mean and covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>~numpy.ndarray</cite>) – 2-D array containing data samples. Shape is (M, N) where N is the
number of variables and M is the number of samples or observations.
This is ordering is equivalent to using <code class="docutils literal notranslate"><span class="pre">rowvar=0</span></code> in numpy.cov.</p></li>
<li><p><strong>weights</strong> (<cite>~numpy.ndarray</cite>) – 1-D array of sample weights. Shape is (M,).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean</strong> (<cite>~numpy.ndarray</cite>) – Weighted average of samples, with shape (N,).</p></li>
<li><p><strong>cov</strong> (<cite>~numpy.ndarray</cite>) – The covariance matrix of the variables with shape (N, N).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Implements formula described here:
<a class="reference external" href="https://en.wikipedia.org/wiki/Sample_mean_and_sample_covariance">https://en.wikipedia.org/wiki/Sample_mean_and_sample_covariance</a>
(see “weighted samples” section)</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.nestle.print_progress">
<code class="sig-prename descclassname"><span class="pre">RMutils.nestle.</span></code><code class="sig-name descname"><span class="pre">print_progress</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.nestle.print_progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function that prints a running total on a single line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>info</strong> (<em>dict</em>) – Dictionary containing keys <code class="docutils literal notranslate"><span class="pre">'it'</span></code> and <code class="docutils literal notranslate"><span class="pre">'logz'</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="RMutils.nestle.resample_equal">
<code class="sig-prename descclassname"><span class="pre">RMutils.nestle.</span></code><code class="sig-name descname"><span class="pre">resample_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.nestle.resample_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample the samples so that the final samples all have equal weight.</p>
<p>Each input sample appears in the output array either
<cite>floor(weights[i] * N)</cite> or <cite>ceil(weights[i] * N)</cite> times, with
<cite>floor</cite> or <cite>ceil</cite> randomly selected (weighted by proximity).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<cite>~numpy.ndarray</cite>) – Unequally weight samples returned by the nested sampling algorithm.
Shape is (N, …), with N the number of samples.</p></li>
<li><p><strong>weights</strong> (<cite>~numpy.ndarray</cite>) – Weight of each sample. Shape is (N,).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>equal_weight_samples</strong> – Samples with equal weights, same shape as input samples.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>~numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nestle</span><span class="o">.</span><span class="n">resample_equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="go">array([[ 1.,  1.],</span>
<span class="go">       [ 1.,  1.],</span>
<span class="go">       [ 1.,  1.],</span>
<span class="go">       [ 3.,  3.]])</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Implements the systematic resampling method described in
<a class="reference external" href="http://people.isy.liu.se/rt/schon/Publications/HolSG2006.pdf">this PDF</a>.
Another way to sample according to weights would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">new_samples</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="p">)]</span>
</pre></div>
</div>
<p>However, the method used in this function is less “noisy”.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.nestle.sample">
<code class="sig-prename descclassname"><span class="pre">RMutils.nestle.</span></code><code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loglikelihood</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxcall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlogz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decline_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.nestle.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform nested sampling to evaluate Bayesian evidence.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul>
<li><p><strong>loglikelihood</strong> (<em>function</em>) – Function returning log(likelihood) given parameters as a 1-d numpy
array of length <em>ndim</em>.</p></li>
<li><p><strong>prior_transform</strong> (<em>function</em>) – Function translating a unit cube to the parameter space according to
the prior. The input is a 1-d numpy array with length <em>ndim</em>, where
each value is in the range [0, 1). The return value should also be a
1-d numpy array with length <em>ndim</em>, where each value is a parameter.
The return value is passed to the loglikelihood function. For example,
for a 2 parameter model with flat priors in the range [0, 2), the
function would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prior_transform</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">u</span>
</pre></div>
</div>
</li>
<li><p><strong>ndim</strong> (<em>int</em>) – Number of parameters returned by prior and accepted by loglikelihood.</p></li>
<li><p><strong>npoints</strong> (<em>int, optional</em>) – Number of active points. Larger numbers result in a more finely
sampled posterior (more accurate evidence), but also a larger
number of iterations required to converge. Default is 100.</p></li>
<li><p><strong>method</strong> (<em>{‘classic’, ‘single’, ‘multi’}, optional</em>) – Method used to select new points. Choices are ‘classic’,
single-ellipsoidal (‘single’), multi-ellipsoidal (‘multi’). Default
is ‘single’.</p></li>
<li><p><strong>update_interval</strong> (<em>int, optional</em>) – Only update the new point selector every <code class="docutils literal notranslate"><span class="pre">update_interval</span></code>-th
likelihood call. Update intervals larger than 1 can be more efficient
when the likelihood function is very fast, particularly when
using the multi-ellipsoid method. Default is round(0.6 * npoints).</p></li>
<li><p><strong>npdim</strong> (<em>int, optional</em>) – Number of parameters accepted by prior. This might differ from <em>ndim</em>
in the case where a parameter of loglikelihood is dependent upon
multiple independently distributed parameters, some of which may be
nuisance parameters.</p></li>
<li><p><strong>maxiter</strong> (<em>int, optional</em>) – Maximum number of iterations. Iteration may stop earlier if
termination condition is reached. Default is no limit.</p></li>
<li><p><strong>maxcall</strong> (<em>int, optional</em>) – Maximum number of likelihood evaluations. Iteration may stop earlier
if termination condition is reached. Default is no limit.</p></li>
<li><p><strong>dlogz</strong> (<em>float, optional</em>) – If supplied, iteration will stop when the estimated contribution
of the remaining prior volume to the total evidence falls below
this threshold. Explicitly, the stopping criterion is
<code class="docutils literal notranslate"><span class="pre">log(z</span> <span class="pre">+</span> <span class="pre">z_est)</span> <span class="pre">-</span> <span class="pre">log(z)</span> <span class="pre">&lt;</span> <span class="pre">dlogz</span></code> where <em>z</em> is the current evidence
from all saved samples, and <em>z_est</em> is the estimated contribution
from the remaining volume. This option and decline_factor are
mutually exclusive. If neither is specified, the default is
<code class="docutils literal notranslate"><span class="pre">dlogz=0.5</span></code>.</p></li>
<li><p><strong>decline_factor</strong> (<em>float, optional</em>) – If supplied, iteration will stop when the weight
(likelihood times prior volume) of newly saved samples has been
declining for <code class="docutils literal notranslate"><span class="pre">decline_factor</span> <span class="pre">*</span> <span class="pre">nsamples</span></code> consecutive samples.
A value of 1.0 seems to work pretty well. This option and dlogz
are mutually exclusive.</p></li>
<li><p><strong>rstate</strong> (<cite>~numpy.random.RandomState</cite>, optional) – RandomState instance. If not given, the global random state of the
<code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> module will be used.</p></li>
<li><p><strong>callback</strong> (<em>function, optional</em>) – Callback function to be called at each iteration. A single argument,
a dictionary, is passed to the callback. The keys include <code class="docutils literal notranslate"><span class="pre">'it'</span></code>,
the current iteration number, and <code class="docutils literal notranslate"><span class="pre">'logz'</span></code>, the current total
log evidence of all saved points. To simply print these at each
iteration, use the convience function
<code class="docutils literal notranslate"><span class="pre">callback=nestle.print_progress</span></code>.</p></li>
<li><p><strong>queue_size</strong> (<em>int, optional</em>) – Carry out evaluation in parallel by queueing up new active point
proposals using at most this many threads. Each thread independently
proposes new live points until one is selected.
Default is no parallelism (queue_size=1).</p></li>
<li><p><strong>pool</strong> (<em>ThreadPoolExecutor</em>) – Use this pool of workers to propose live points in parallel. If
queue_size&gt;1 and <cite>pool</cite> is not specified, an Exception will be thrown.</p></li>
</ul>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>steps</strong> (<em>int, optional</em>) – For the ‘classic’ method, the number of steps to take when selecting
a new point. Default is 20.</p></li>
<li><p><strong>enlarge</strong> (<em>float, optional</em>) – For the ‘single’ and ‘multi’ methods, enlarge the ellipsoid(s) by
this fraction in volume. Default is 1.2.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>result</strong> – A dictionary-like object with attribute access: Attributes can be
accessed with, for example, either <code class="docutils literal notranslate"><span class="pre">result['niter']</span></code> or
<code class="docutils literal notranslate"><span class="pre">result.niter</span></code>. Attributes:</p>
<dl class="simple">
<dt>niter <em>(int)</em></dt><dd><p>Number of iterations.</p>
</dd>
<dt>ncall <em>(int)</em></dt><dd><p>Number of likelihood calls.</p>
</dd>
<dt>logz <em>(float)</em></dt><dd><p>Natural logarithm of evidence (integral of posterior).</p>
</dd>
<dt>logzerr <em>(float)</em></dt><dd><p>Estimated numerical (sampling) error on <em>logz</em>.</p>
</dd>
<dt>h <em>(float)</em></dt><dd><p>Information. This is a measure of the “peakiness” of the
likelihood function. A constant likelihood has zero information.</p>
</dd>
<dt>samples <em>(ndarray)</em></dt><dd><p>Parameter values of each sample. Shape is <em>(nsamples, ndim)</em>.</p>
</dd>
<dt>logvol <em>(ndarray)</em></dt><dd><p>Natural log of prior volume of corresponding to each sample.
Shape is <em>(nsamples,)</em>.</p>
</dd>
<dt>logl <em>(ndarray)</em></dt><dd><p>Natural log of the likelihood for each sample, as returned by
user-supplied <em>logl</em> function. Shape is <em>(nsamples,)</em>.</p>
</dd>
<dt>weights <em>(ndarray)</em></dt><dd><p>Weight corresponding to each sample, normalized to unity.
These are proportional to <code class="docutils literal notranslate"><span class="pre">exp(logvol</span> <span class="pre">+</span> <span class="pre">logl)</span></code>. Shape is
<em>(nsamples,)</em>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>Result</cite></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-RMutils.normalize">
<span id="rmutils-normalize-module"></span><h2>RMutils.normalize module<a class="headerlink" href="#module-RMutils.normalize" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="RMutils.normalize.APLpyNormalize">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">RMutils.normalize.</span></code><code class="sig-name descname"><span class="pre">APLpyNormalize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stretch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.normalize.APLpyNormalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.colors.Normalize</span></code></p>
<p>A Normalize class for imshow that allows different stretching functions
for astronomical images.</p>
<dl class="py method">
<dt id="RMutils.normalize.APLpyNormalize.inverse">
<code class="sig-name descname"><span class="pre">inverse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.normalize.APLpyNormalize.inverse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-RMutils.util_FITS">
<span id="rmutils-util-fits-module"></span><h2>RMutils.util_FITS module<a class="headerlink" href="#module-RMutils.util_FITS" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="RMutils.util_FITS.create_simple_fits_hdu">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_FITS.</span></code><code class="sig-name descname"><span class="pre">create_simple_fits_hdu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dFreq_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xCent_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yCent_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamMinFWHM_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0004166666666666667</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamMajFWHM_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0004166666666666667</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamPA_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixScale_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.333333333333333e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'I'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EQU'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_FITS.create_simple_fits_hdu" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a blank HDU centred on a given coordinate and shape</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_FITS.get_beam_area">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_FITS.</span></code><code class="sig-name descname"><span class="pre">get_beam_area</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bmaj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_FITS.get_beam_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the effective beam area in pixels given the major and minor
Gaussian beam FWHM and the pixel-scale.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_FITS.get_beam_from_header">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_FITS.</span></code><code class="sig-name descname"><span class="pre">get_beam_from_header</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_FITS.get_beam_from_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the beam FWHM and PA from the FITS header. Will return ‘None’ for
missing cards.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_FITS.get_subfits">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_FITS.</span></code><code class="sig-name descname"><span class="pre">get_subfits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inFileName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zMin_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zMax_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do3D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapX180</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_FITS.get_subfits" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut out a sub-section of a FITS file (cube or map).</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_FITS.mkWCSDict">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_FITS.</span></code><code class="sig-name descname"><span class="pre">mkWCSDict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapX180</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forceCheckDims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_FITS.mkWCSDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse and calculate key WCS parameters using python WCSLIB.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_FITS.strip_fits_dims">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_FITS.</span></code><code class="sig-name descname"><span class="pre">strip_fits_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minDim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forceCheckDims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_FITS.strip_fits_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip array and / or header dimensions from a FITS data-array or header.</p>
</dd></dl>

</div>
<div class="section" id="module-RMutils.util_RM">
<span id="rmutils-util-rm-module"></span><h2>RMutils.util_RM module<a class="headerlink" href="#module-RMutils.util_RM" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="RMutils.util_RM.RMcleaner">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">RMcleaner</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RMSFArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi2Arr_radm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr_radm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhmRMSFArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterCountArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.RMcleaner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Allows do_rmclean_hogbom to be run in parallel
Designed around use of schwimmbad parallelization tools.</p>
<dl class="py method">
<dt id="RMutils.util_RM.RMcleaner.cleanloop">
<code class="sig-name descname"><span class="pre">cleanloop</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.RMcleaner.cleanloop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.calc_normal_tests">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">calc_normal_tests</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.calc_normal_tests" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate metrics measuring deviation of an array from Normal.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.calc_sigma_add">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">calc_sigma_add</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yMed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.calc_sigma_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the most likely value of additional scatter, assuming the
input data is drawn from a normal distribution. The total uncertainty on
each data point Y_i is modelled as dYtot_i**2 = dY_i**2 + dYadd**2.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.cdf_percentile">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">cdf_percentile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.cdf_percentile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value at a given percentile of a cumulative distribution
function.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.detect_peak">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">detect_peak</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.detect_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect the extent of the peak in the array by moving away, in both
directions, from the peak channel amd looking for where the value drops
below a threshold.
Returns a mask array like the input array with 1s over the extent of the
peak and 0s elsewhere.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.do_rmclean">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">do_rmclean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirtyFDF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMSFArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMSFphiArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhmRMSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitRMSFreal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doPlots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.do_rmclean" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Hogbom (Heald) clean on a single RM spectrum.</p>
<p><strong>* Depricated by the ‘do_rmsynth_hogbom’ routine, above. *</strong></p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.do_rmclean_hogbom">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">do_rmclean_hogbom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dirtyFDF</span></em>, <em class="sig-param"><span class="pre">phiArr_radm2</span></em>, <em class="sig-param"><span class="pre">RMSFArr</span></em>, <em class="sig-param"><span class="pre">phi2Arr_radm2</span></em>, <em class="sig-param"><span class="pre">fwhmRMSFArr</span></em>, <em class="sig-param"><span class="pre">cutoff</span></em>, <em class="sig-param"><span class="pre">maxIter=1000</span></em>, <em class="sig-param"><span class="pre">gain=0.1</span></em>, <em class="sig-param"><span class="pre">mskArr=None</span></em>, <em class="sig-param"><span class="pre">nBits=32</span></em>, <em class="sig-param"><span class="pre">verbose=False</span></em>, <em class="sig-param"><span class="pre">doPlots=False</span></em>, <em class="sig-param"><span class="pre">pool=None</span></em>, <em class="sig-param"><span class="pre">chunksize=None</span></em>, <em class="sig-param"><span class="pre">log=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.do_rmclean_hogbom" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Hogbom CLEAN on a cube of complex Faraday dispersion functions
given a cube of rotation measure spread functions.</p>
<p>dirtyFDF       … 1, 2 or 3D complex FDF array
phiArr_radm2   … 1D Faraday depth array corresponding to the FDF
RMSFArr        … 1, 2 or 3D complex RMSF array
phi2Arr_radm2  … double size 1D Faraday depth array of the RMSF
fwhmRMSFArr    … scalar, 1D or 2D array of RMSF main lobe widths
cutoff         … clean cutoff (+ve = absolute values, -ve = sigma) [-1]
maxIter        … maximun number of CLEAN loop interations [1000]
gain           … CLEAN loop gain [0.1]
mskArr         … scalar, 1D or 2D pixel mask array [None]
nBits          … precision of data arrays [32]
verbose        … print feedback during calculation [False]
doPlots        … plot the final CLEAN FDF [False]
pool           … thread pool for multithreading (from schwimmbad) [None]
chunksize      … number of pixels to be given per thread (for 3D) [None]
log            … function to be used to output messages [print]</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.do_rmsynth">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">do_rmsynth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataQ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.do_rmsynth" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform RM-synthesis on Stokes Q and U cubes. This version operates on
data in spectral order, i.e., [zyx] =&gt; [yxz] (np.transpose(dataQ, (1,2,0)).</p>
<p><strong>* Depricated by the faster ‘do_rmsynth_planes’ routine, above. *</strong></p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.do_rmsynth_planes">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">do_rmsynth_planes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dataQ</span></em>, <em class="sig-param"><span class="pre">dataU</span></em>, <em class="sig-param"><span class="pre">lambdaSqArr_m2</span></em>, <em class="sig-param"><span class="pre">phiArr_radm2</span></em>, <em class="sig-param"><span class="pre">weightArr=None</span></em>, <em class="sig-param"><span class="pre">lam0Sq_m2=None</span></em>, <em class="sig-param"><span class="pre">nBits=32</span></em>, <em class="sig-param"><span class="pre">verbose=False</span></em>, <em class="sig-param"><span class="pre">log=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.do_rmsynth_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform RM-synthesis on Stokes Q and U cubes (1,2 or 3D). This version
of the routine loops through spectral planes and is faster than the pixel-
by-pixel code. This version also correctly deals with isolated clumps of
NaN-flagged voxels within the data-cube (unlikely in interferometric cubes,
but possible in single-dish cubes). Input data must be in standard python
[z,y,x] order, where z is the frequency axis in ascending order.</p>
<p>dataQ           … 1, 2 or 3D Stokes Q data array
dataU           … 1, 2 or 3D Stokes U data array
lambdaSqArr_m2  … vector of wavelength^2 values (assending freq order)
phiArr_radm2    … vector of trial Faraday depth values
weightArr       … vector of weights, default [None] is Uniform (all 1s)
nBits           … precision of data arrays [32]
verbose         … print feedback during calculation [False]
log             … function to be used to output messages [print]</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.extrap">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">extrap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.extrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to allow np.interp to linearly extrapolate at function ends.</p>
<p>np.interp function with linear extrapolation
<a class="reference external" href="http://stackoverflow.com/questions/2745329/how-to-make-scipy-interpolate">http://stackoverflow.com/questions/2745329/how-to-make-scipy-interpolate</a>
-give-a-an-extrapolated-result-beyond-the-input-ran</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.fit_rmsf">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">fit_rmsf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ampThresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.fit_rmsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the main lobe of the RMSF with a Gaussian function.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.fits_make_lin_axis">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">fits_make_lin_axis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f4'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.fits_make_lin_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an array containing the axis values, assuming a simple linear
projection scheme. Axis selection is zero-indexed.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.gauss1D">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">gauss1D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.gauss1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which returns another function to evaluate a Gaussian</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.get_RMSF">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">get_RMSF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lamSqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weightArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam0Sq_m2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitRMSFreal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.get_RMSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the RMSF from 1D wavelength^2 and Faraday depth arrays.</p>
<p><strong>* Depricated by the faster ‘get_rmsf_planes’ routine, above. *</strong></p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.get_rmsf_planes">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">get_rmsf_planes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">lambdaSqArr_m2</span></em>, <em class="sig-param"><span class="pre">phiArr_radm2</span></em>, <em class="sig-param"><span class="pre">weightArr=None</span></em>, <em class="sig-param"><span class="pre">mskArr=None</span></em>, <em class="sig-param"><span class="pre">lam0Sq_m2=None</span></em>, <em class="sig-param"><span class="pre">double=True</span></em>, <em class="sig-param"><span class="pre">fitRMSF=False</span></em>, <em class="sig-param"><span class="pre">fitRMSFreal=False</span></em>, <em class="sig-param"><span class="pre">nBits=32</span></em>, <em class="sig-param"><span class="pre">verbose=False</span></em>, <em class="sig-param"><span class="pre">log=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.get_rmsf_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Rotation Measure Spread Function from inputs. This version
returns a cube (1, 2 or 3D) of RMSF spectra based on the shape of a
boolean mask array, where flagged data are True and unflagged data False.
If only whole planes (wavelength channels) are flagged then the RMSF is the
same for all pixels and the calculation is done once and replicated to the
dimensions of the mask. If some isolated voxels are flagged then the RMSF
is calculated by looping through each wavelength plane, which can take some
time. By default the routine returns the analytical width of the RMSF main
lobe but can also use MPFIT to fit a Gaussian.</p>
<p>lambdaSqArr_m2  … vector of wavelength^2 values (assending freq order)
phiArr_radm2    … vector of trial Faraday depth values
weightArr       … vector of weights, default [None] is no weighting
maskArr         … cube of mask values used to shape return cube [None]
lam0Sq_m2       … force a reference lambda^2 value (def=calculate) [None]
double          … pad the Faraday depth to double-size [True]
fitRMSF         … fit the main lobe of the RMSF with a Gaussian [False]
fitRMSFreal     … fit RMSF.real, rather than abs(RMSF) [False]
nBits           … precision of data arrays [32]
verbose         … print feedback during calculation [False]
log             … function to be used to output messages [print]</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.measure_FDF_parms">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">measure_FDF_parms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FDF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhmRMSF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dFDF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqArr_m2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam0Sq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrDoBiasCorrect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.measure_FDF_parms" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure standard parameters from a complex Faraday Dispersion Function.
Currently this function assumes that the noise levels in the Stokes Q
and U spectra are the same.
Returns a dictionary containing measured parameters.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.measure_fdf_complexity">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">measure_fdf_complexity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FDF</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.measure_fdf_complexity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.measure_qu_complexity">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">measure_qu_complexity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RM_radm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.measure_qu_complexity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.norm_cdf">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">norm_cdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.norm_cdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the CDF of a normal distribution between -6 and 6 sigma, or at
the values of an input array.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.plot_complexity">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">plot_complexity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RM_radm2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.plot_complexity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.threeDnoise_do_rmsynth_planes">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">threeDnoise_do_rmsynth_planes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dataQ</span></em>, <em class="sig-param"><span class="pre">dataU</span></em>, <em class="sig-param"><span class="pre">lambdaSqArr_m2</span></em>, <em class="sig-param"><span class="pre">phiArr_radm2</span></em>, <em class="sig-param"><span class="pre">weightArr=None</span></em>, <em class="sig-param"><span class="pre">lam0Sq_m2=None</span></em>, <em class="sig-param"><span class="pre">nBits=32</span></em>, <em class="sig-param"><span class="pre">verbose=False</span></em>, <em class="sig-param"><span class="pre">log=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.threeDnoise_do_rmsynth_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform RM-synthesis on Stokes Q and U cubes (1,2 or 3D). This version
of the routine loops through spectral planes and is faster than the pixel-
by-pixel code. This version also correctly deals with isolated clumps of
NaN-flagged voxels within the data-cube (unlikely in interferometric cubes,
but possible in single-dish cubes). Input data must be in standard python
[z,y,x] order, where z is the frequency axis in ascending order.</p>
<p>dataQ           … 1, 2 or 3D Stokes Q data array
dataU           … 1, 2 or 3D Stokes U data array
lambdaSqArr_m2  … vector of wavelength^2 values (assending freq order)
phiArr_radm2    … vector of trial Faraday depth values
weightArr       … 1, 2 or 3D array of weights, default [None] is Uniform (all 1s)
nBits           … precision of data arrays [32]
verbose         … print feedback during calculation [False]</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>FDFcube     … 1, 2, or 3D complex array of Faraday spectra
lam0Sq_m2   … 0, 1, or 2D array of lambda_0^2 values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_RM.threeDnoise_get_rmsf_planes">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_RM.</span></code><code class="sig-name descname"><span class="pre">threeDnoise_get_rmsf_planes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">lambdaSqArr_m2</span></em>, <em class="sig-param"><span class="pre">phiArr_radm2</span></em>, <em class="sig-param"><span class="pre">weightArr=None</span></em>, <em class="sig-param"><span class="pre">lam0Sq_m2=None</span></em>, <em class="sig-param"><span class="pre">double=True</span></em>, <em class="sig-param"><span class="pre">fitRMSF=False</span></em>, <em class="sig-param"><span class="pre">fitRMSFreal=False</span></em>, <em class="sig-param"><span class="pre">nBits=32</span></em>, <em class="sig-param"><span class="pre">verbose=False</span></em>, <em class="sig-param"><span class="pre">log=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_RM.threeDnoise_get_rmsf_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Rotation Measure Spread Function from inputs. This version
returns a cube (1, 2 or 3D) of RMSF spectra based on the shape of a
boolean mask and/or weight array, where flagged data are True and unflagged data False.
If only whole planes (wavelength channels) are flagged then the RMSF is the
same for all pixels and the calculation is done once and replicated to the
dimensions of the mask. If some isolated voxels are flagged then the RMSF
is calculated by looping through each wavelength plane, which can take some
time. By default the routine returns the analytical width of the RMSF main
lobe but can also use MPFIT to fit a Gaussian.
This version assumes that masking for bad voxels has already been applied to the
weight array (as zeros or NaNs).
If no weight array is supplied, uniform (equal) weights are assumed.</p>
<p>lambdaSqArr_m2  … vector of wavelength^2 values (assending freq order)
phiArr_radm2    … vector of trial Faraday depth values
weightArr       … array (1/2/3D) of weights, default [None] is no weighting
lam0Sq_m2       … force a reference lambda^2 value (def=calculate) [None]
double          … pad the Faraday depth to double-size [True]
fitRMSF         … fit the main lobe of the RMSF with a Gaussian [False]
fitRMSFreal     … fit RMSF.real, rather than abs(RMSF) [False]
nBits           … precision of data arrays [32]
verbose         … print feedback during calculation [False]</p>
</dd></dl>

</div>
<div class="section" id="module-RMutils.util_misc">
<span id="rmutils-util-misc-module"></span><h2>RMutils.util_misc module<a class="headerlink" href="#module-RMutils.util_misc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="RMutils.util_misc.MAD">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">MAD</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6745</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.MAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Median Absolute Deviation along given axis of an array:
median(abs(a - median(a))) / c
c = 0.6745 is the constant to convert from MAD to std</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.calc_mom2_FDF">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">calc_mom2_FDF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FDF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.calc_mom2_FDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 2nd moment of the polarised intensity FDF. Can be applied to
a clean component spectrum or a standard FDF</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.calc_parabola_vertex">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">calc_parabola_vertex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.calc_parabola_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the vertex of a parabola given three adjacent points.
Normalization of coordinates must be performed first to reduce risk of
floating point errors.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.calc_stats">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">calc_stats</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskzero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.calc_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the statistics of an array.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.calculate_StokesI_model">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">calculate_StokesI_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.calculate_StokesI_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates channel values for a Stokes I model.
Inputs: fitDict: a dictionary returned from the Stokes I model fitting.</p>
<blockquote>
<div><p>freqArr_Hz: an array of frequency values (assumed to be in Hz).</p>
</div></blockquote>
<p>Returns: array containing Stokes I model values corresponding to each frequency.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.cleanup_str_input">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">cleanup_str_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">textBlock</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.cleanup_str_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.config_read">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">config_read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'='</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doValueSplit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.config_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a configuration file and output a ‘KEY=VALUE’ dictionary.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_IQU_spectra_RMthin">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_IQU_spectra_RMthin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RM_radm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq0_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_IQU_spectra_RMthin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Stokes I, Q &amp; U spectra for a Faraday thin source</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_IQU_spectra_burn">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_IQU_spectra_burn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPolArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0Arr_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMArr_radm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaRMArr_radm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq0_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_IQU_spectra_burn" title="Permalink to this definition">¶</a></dt>
<dd><p>Create Stokes I, Q &amp; U spectra for a source with 1 or more polarised
Faraday components affected by external (burn) depolarisation.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_IQU_spectra_diff">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_IQU_spectra_diff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPolArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0Arr_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMArr_radm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq0_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_IQU_spectra_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Create Stokes I, Q &amp; U spectra for a source with 1 or more polarised
Faraday components affected by internal Faraday depolarisation</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_frac_spectra">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_frac_spectra</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dIArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dQArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dUArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyOrd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_frac_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the Stokes I spectrum with a polynomial and divide into the Q &amp; U
spectra to create fractional spectra.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_pqu_resid_RMthin">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_pqu_resid_RMthin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RM_radm2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_pqu_resid_RMthin" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract a RM-thin component from the fractional q and u data.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_pqu_spectra_RMthin">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_pqu_spectra_RMthin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RM_radm2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_pqu_spectra_RMthin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return fractional P/I, Q/I &amp; U/I spectra for a Faraday thin source</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_pqu_spectra_burn">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_pqu_spectra_burn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPolArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0Arr_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMArr_radm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaRMArr_radm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_pqu_spectra_burn" title="Permalink to this definition">¶</a></dt>
<dd><p>Return fractional P/I, Q/I &amp; U/I spectra for a sum of Faraday thin
components (multiple values may be given as a list for each argument).
Burn-law external depolarisation may be applied to each
component via the optional ‘sigmaRMArr_radm2’ argument. If
sigmaRMArr_radm2=None, all values are set to zero, i.e., no
depolarisation.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.create_pqu_spectra_diff">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">create_pqu_spectra_diff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracPolArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi0Arr_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMArr_radm2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.create_pqu_spectra_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Return fractional P/I, Q/I &amp; U/I spectra for a sum of Faraday
components which are affected by internal (differential) Faraday
depolariation.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.csv_read_to_list">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">csv_read_to_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doFloat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.csv_read_to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Read rows from an ASCII file into a list of lists.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.deg2dms">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">deg2dms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">':'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doSign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nPlaces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.deg2dms" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a float in degrees to ‘dd mm ss’ format.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.extrap">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">extrap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.extrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to allow np.interp to linearly extrapolate at function ends.</p>
<p>np.interp function with linear extrapolation
<a class="reference external" href="http://stackoverflow.com/questions/2745329/how-to-make-scipy-interpolate">http://stackoverflow.com/questions/2745329/how-to-make-scipy-interpolate</a>
-give-a-an-extrapolated-result-beyond-the-input-ran</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.fit_StokesI_model">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">fit_StokesI_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dIArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyOrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.fit_StokesI_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.fit_spec_poly5">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">fit_spec_poly5</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyData</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.fit_spec_poly5" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a 5th order polynomial to a spectrum. To avoid overflow errors the
X-axis data should not be large numbers (e.g.: x10^9 Hz; use GHz
instead).</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.interp_images">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">interp_images</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.interp_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an interpolated image between two other images.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.nanmean">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">nanmean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.nanmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns mean ignoring NaNs.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.nanmedian">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">nanmedian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.nanmedian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns median ignoring NaNs.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.nanstd">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">nanstd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.nanstd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns standard deviation ignoring NaNs.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.norm_cdf">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">norm_cdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.norm_cdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the CDF of a normal distribution between -6 and 6 sigma, or at
the values of an input array.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.poly5">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">poly5</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.poly5" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function to evaluate a polynomial. The subfunction can be
accessed via ‘argument unpacking’ like so: ‘y = poly5(p)(<a href="#id1"><span class="problematic" id="id2">*</span></a>x)’,
where x is a vector of X values and p is a vector of coefficients.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.powerlaw_poly5">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">powerlaw_poly5</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.powerlaw_poly5" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function to evaluate a power law polynomial. The subfunction can be
accessed via ‘argument unpacking’ like so: ‘y = powerlaw_poly5(p)(<a href="#id3"><span class="problematic" id="id4">*</span></a>x)’,
where x is a vector of X values and p is a vector of coefficients.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.progress">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">progress</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a progress bar to the terminal.
Stolen from Mike Bell.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.renormalize_StokesI_model">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">renormalize_StokesI_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_reference_frequency</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.renormalize_StokesI_model" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions adjusts the reference frequency for the Stokes I model
and fixes the fit parameters such that the the model is the same. This is
important because the initial Stokes I fitted model uses an arbitrary
reference frequency, and it may be desirable for users to know the exact
reference frequency of the model.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.sort_nicely">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">sort_nicely</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.sort_nicely" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort a list in the order a human would.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.split_repeat_lst">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">split_repeat_lst</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inLst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nPre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nRepeat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.split_repeat_lst" title="Permalink to this definition">¶</a></dt>
<dd><p>Split entries in a list into a preamble and repeating columns. The
repeating entries are pushed into a 2D array of type float64.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.toscalar">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">toscalar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.toscalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a scalar version of a Numpy object.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.twodgaussian">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">twodgaussian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.twodgaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a 2D Gaussian ellipse as parameterised by ‘params’ for a region with
‘shape’</p>
<blockquote>
<div><dl class="simple">
<dt>params - [amp, xo, yo, cx, cy, pa] where:</dt><dd><p>amp - amplitude
xo  - centre of Gaussian in X
yo  - centre of Gaussian in Y
cx  - width of Gaussian in X (sigma or c, not FWHM)
cy  - width of Gaussian in Y (sigma or c, not FWHM)
pa  - position angle of Gaussian, aka theta (radians)</p>
</dd>
</dl>
<p>shape - (y, x) dimensions of region</p>
</div></blockquote>
<p>Returns a 2D numpy array with shape=”shape”</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_misc.xfloat">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_misc.</span></code><code class="sig-name descname"><span class="pre">xfloat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_misc.xfloat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-RMutils.util_plotFITS">
<span id="rmutils-util-plotfits-module"></span><h2>RMutils.util_plotFITS module<a class="headerlink" href="#module-RMutils.util_plotFITS" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="RMutils.util_plotFITS.label_format_deg">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotFITS.</span></code><code class="sig-name descname"><span class="pre">label_format_deg</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotFITS.label_format_deg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotFITS.label_format_dms">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotFITS.</span></code><code class="sig-name descname"><span class="pre">label_format_dms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotFITS.label_format_dms" title="Permalink to this definition">¶</a></dt>
<dd><p>Format decimal-&gt;DD:MM:SS. Called by the label formatter.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotFITS.label_format_hms">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotFITS.</span></code><code class="sig-name descname"><span class="pre">label_format_hms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotFITS.label_format_hms" title="Permalink to this definition">¶</a></dt>
<dd><p>Format decimal-&gt;HH:MM:SS. Called by the label formatter.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotFITS.plot_fits_map">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotFITS.</span></code><code class="sig-name descname"><span class="pre">plot_fits_map</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaleFrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmapName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gist_heat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zMin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annEllipseLst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annPolyLst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doColbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotFITS.plot_fits_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a colourscale image of a FITS map.</p>
<dl class="simple">
<dt>annEllipseLst is a list of lists:</dt><dd><p>annEllipseLst[0][i] = x_deg
annEllipseLst[1][i] = y_deg
annEllipseLst[2][i] = minor_deg
annEllipseLst[3][i] = major_deg
annEllipseLst[4][i] = pa_deg
annEllipseLst[5][i] = colour … optional, default to ‘g’</p>
</dd>
<dt>annPolyLst is also a list of lists:</dt><dd><p>annPolyLst[0][i] = list of polygon coords = [[x1,y1], [x2, y2] …]
annPolyLst[1][i] = colour of polygon e.g., ‘w’</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-RMutils.util_plotTk">
<span id="rmutils-util-plottk-module"></span><h2>RMutils.util_plotTk module<a class="headerlink" href="#module-RMutils.util_plotTk" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="RMutils.util_plotTk.CustomNavbar">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">CustomNavbar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">canvas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.CustomNavbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.backends._backend_tk.NavigationToolbar2Tk</span></code></p>
<p>Custom navigation toolbar subclass</p>
<dl class="py method">
<dt id="RMutils.util_plotTk.CustomNavbar.toggle_legend">
<code class="sig-name descname"><span class="pre">toggle_legend</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.CustomNavbar.toggle_legend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.filter_range_indx">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">filter_range_indx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataMin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filterNans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.filter_range_indx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a boolean array [True, …] where data falls outside of the
range [dataMin &lt;= a &lt;= dataMax].</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.format_ticks">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">format_ticks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.format_ticks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.gauss">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">gauss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fucntion to evaluate a Gaussian with parameters
p = [amp, mean, FWHM]</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.label_format_exp">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">label_format_exp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">switchExp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.label_format_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function to format labels for log axes. Switches to a power
format for log10(<a href="#id5"><span class="problematic" id="id6">|number|</span></a>) &gt;= switchExp.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.mk_hist_poly">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">mk_hist_poly</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logScaleY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeroPt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addZeroPt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.mk_hist_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the line segments for the a polygon used to draw a histogram</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotCleanFDF">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotCleanFDF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotCleanFDF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotDirtyFDF">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotDirtyFDF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotDirtyFDF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotFracPol">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotFracPol</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotFracPol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotFracQvsU">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotFracQvsU</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotFracQvsU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotPolang">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotPolang</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotPolang" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotPolresidual">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotPolresidual</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotPolresidual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotPolsummary">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotPolsummary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotPolsummary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotRMSF">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotRMSF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotRMSF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotSctHstQuery">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotSctHstQuery</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotParm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotSctHstQuery" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotSpecIPQU">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotSpecIPQU</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotSpecIPQU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotSpecRMS">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotSpecRMS</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotSpecRMS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotStampI">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotStampI</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotStampI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plotStampP">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plotStampP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataMan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fig'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plotStampP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_I_vs_nu_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_I_vs_nu_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dIArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqHirArr_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_I_vs_nu_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the I spectrum and an optional model.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_Ipqu_spectra_fig">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_Ipqu_spectra_fig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dIArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqHirArr_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_Ipqu_spectra_fig" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the Stokes I, Q/I &amp; U/I spectral summary plots.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_PQU_vs_nu_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_PQU_vs_nu_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dQArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dUArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqHirArr_Hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QmodArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UmodArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_PQU_vs_nu_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the P, Q &amp; U spectrum and an optional model.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_RMSF_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_RMSF_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMSFArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhmRMSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doTitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_RMSF_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_cleanFDF_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_cleanFDF_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanFDFArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccFDFArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirtyFDFArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussParm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Clean</span> <span class="pre">FDF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showComplex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_cleanFDF_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_cleanFDF_fig">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_cleanFDF_fig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanFDFArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccFDFArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirtyFDFArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residFDFArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussParm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Clean</span> <span class="pre">FDF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showComplex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_cleanFDF_fig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_complexity_fig">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_complexity_fig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaAddqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chiSqRedqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probqArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaAdduArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chiSqReduArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probuArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">med</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_complexity_fig" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the residual Stokes q and u complexity plots.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_dirtyFDF_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_dirtyFDF_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FDFArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussParm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vLine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Dirty</span> <span class="pre">FDF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doTitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_dirtyFDF_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_hist4_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_hist4_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">popLst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doXlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doYlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">styIndx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xMin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xLabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yLabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legLabLst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legLoc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_hist4_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_pqu_vs_lamsq_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_pqu_vs_lamsq_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqArr_m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqHirArr_m2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_pqu_vs_lamsq_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_psi_vs_lamsq_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_psi_vs_lamsq_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqArr_m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqHirArr_m2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_psi_vs_lamsq_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_q_vs_u_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_q_vs_u_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqArr_m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamSqHirArr_m2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uModArr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_q_vs_u_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_rmsIQU_vs_nu_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_rmsIQU_vs_nu_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqArr_Hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsIArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsQArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsUArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisYright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisXtop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_rmsIQU_vs_nu_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the noise spectra in Stokes I, Q &amp; U.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_rmsf_fdf_fig">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_rmsf_fdf_fig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phiArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FDF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi2Arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMSFArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhmRMSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussParm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vLine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flux</span> <span class="pre">units'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_rmsf_fdf_fig" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the RMSF and FDF on a single figure.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.plot_scatter4_ax">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">plot_scatter4_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">popLst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doXlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doYlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zPower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">styIndx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xMin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yMin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zMin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xLabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yLabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zLabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legLabLst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showCbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show11Line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legLoc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.plot_scatter4_ax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.tweakAxFormat">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">tweakAxFormat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_to_anchor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showLeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.tweakAxFormat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.unwrap_lines">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">unwrap_lines</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">90.0,</span> <span class="pre">90.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.unwrap_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="RMutils.util_plotTk.xint">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_plotTk.</span></code><code class="sig-name descname"><span class="pre">xint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_plotTk.xint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-RMutils.util_rec">
<span id="rmutils-util-rec-module"></span><h2>RMutils.util_rec module<a class="headerlink" href="#module-RMutils.util_rec" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="RMutils.util_rec.fields_view">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_rec.</span></code><code class="sig-name descname"><span class="pre">fields_view</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldNameLst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_rec.fields_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a view of a numpy record array containing only the fields names in
the fields argument. ‘fields’ should be a list of column names.</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_rec.irecarray_to_py">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_rec.</span></code><code class="sig-name descname"><span class="pre">irecarray_to_py</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_rec.irecarray_to_py" title="Permalink to this definition">¶</a></dt>
<dd><p>Slow conversion of a recarray into a list of records with python types.
Get the field names from :attr:’a.dtype.names’.
:Returns: iterator so that one can handle big input arrays</p>
</dd></dl>

<dl class="py function">
<dt id="RMutils.util_rec.pyify">
<code class="sig-prename descclassname"><span class="pre">RMutils.util_rec.</span></code><code class="sig-name descname"><span class="pre">pyify</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typestr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RMutils.util_rec.pyify" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Python :class:’type’ that most closely represents the
type encoded by <em>typestr</em></p>
</dd></dl>

</div>
<div class="section" id="module-RMutils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-RMutils" title="Permalink to this headline">¶</a></h2>
<p>Dependencies for RM utilities</p>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, CIRADA.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>